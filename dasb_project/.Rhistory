library(DMwR)
library(dplyr)
library(corrplot)
library(randomForest)
library(ggplot2)
library(reshape2)
library(corrgram)
students_mat <- read_csv("student-mat.csv")
students_mat$class <- "Mat"
students_por<-read_csv("student-por.csv")
students_por$class <- "Por"
df_raw = rbind(student_por, student_mat)
students_mat <- read_csv("student-mat.csv")
students_mat$class <- "Mat"
students_por<-read_csv("student-por.csv")
students_por$class <- "Por"
df_raw = rbind(student_por, student_mat)
students_mat <- read_csv("student-mat.csv")
students_mat$class <- "Mat"
students_por<-read_csv("student-por.csv")
students_por$class <- "Por"
df_raw = rbind(student_por, student_mat)
df_raw = rbind(students_por, students_mat)
df<-df_raw %>% distinct(school,sex,age,address,famsize,Pstatus,
Medu,Fedu,Mjob,Fjob,reason,
guardian,traveltime,studytime,failures,
schoolsup, famsup,activities,nursery,higher,internet,
romantic,famrel,freetime,goout,Dalc,Walc,health,absences, .keep_all = TRUE)
View(df)
df_factorized <- student_df
df_factorized$class<-as.numeric(factor(df_factorized$class))
df_factorized$famsize<-as.numeric(factor(df_factorized$famsize))
df_factorized$Pstatus<-as.numeric(factor(df_factorized$Pstatus))
df_factorized$address<-as.numeric(factor(df_factorized$address))
df_factorized$sex<-as.numeric(factor(df_factorized$sex))
df_factorized$school<-as.numeric(factor(df_factorized$school))
df_factorized$schoolsup<-as.numeric(factor(df_factorized$schoolsup))
df_factorized$famsup<-as.numeric(factor(df_factorized$famsup))
df_factorized$paid<-as.numeric(factor(df_factorized$paid))
df_factorized$activities<-as.numeric(factor(df_factorized$activities))
df_factorized$nursery<-as.numeric(factor(df_factorized$nursery))
df_factorized$higher<-as.numeric(factor(df_factorized$higher))
df_factorized$internet<-as.numeric(factor(df_factorized$internet))
df_factorized$romantic<-as.numeric(factor(df_factorized$romantic))
df_factorized$guardian<-as.numeric(factor(df_factorized$guardian))
df_factorized$Mjob<-as.numeric(factor(df_factorized$Mjob))
df_factorized$Fjob<-as.numeric(factor(df_factorized$Fjob))
df_factorized$reason<-as.numeric(factor(df_factorized$reason))
#as factor for the categorical Data
df_factorized$Mjob <- as.factor(df$Mjob)
df_factorized$Fjob <- as.factor(df$Fjob)
df_factorized$guardian <- as.factor(df$guardian)
df_factorized$reason <- as.factor(df$reason)
df$Gavg<-(df$G1+df$G2+df$G3)/3
student_df = subset(df, select = -c(G1,G2,G3))
str(student_df)
df_factorized <- student_df
df_factorized$class<-as.numeric(factor(df_factorized$class))
df_factorized$famsize<-as.numeric(factor(df_factorized$famsize))
df_factorized$Pstatus<-as.numeric(factor(df_factorized$Pstatus))
df_factorized$address<-as.numeric(factor(df_factorized$address))
df_factorized$sex<-as.numeric(factor(df_factorized$sex))
df_factorized$school<-as.numeric(factor(df_factorized$school))
df_factorized$schoolsup<-as.numeric(factor(df_factorized$schoolsup))
df_factorized$famsup<-as.numeric(factor(df_factorized$famsup))
df_factorized$paid<-as.numeric(factor(df_factorized$paid))
df_factorized$activities<-as.numeric(factor(df_factorized$activities))
df_factorized$nursery<-as.numeric(factor(df_factorized$nursery))
df_factorized$higher<-as.numeric(factor(df_factorized$higher))
df_factorized$internet<-as.numeric(factor(df_factorized$internet))
df_factorized$romantic<-as.numeric(factor(df_factorized$romantic))
df_factorized$guardian<-as.numeric(factor(df_factorized$guardian))
df_factorized$Mjob<-as.numeric(factor(df_factorized$Mjob))
df_factorized$Fjob<-as.numeric(factor(df_factorized$Fjob))
df_factorized$reason<-as.numeric(factor(df_factorized$reason))
#as factor for the categorical Data
df_factorized$Mjob <- as.factor(df$Mjob)
df_factorized$Fjob <- as.factor(df$Fjob)
df_factorized$guardian <- as.factor(df$guardian)
df_factorized$reason <- as.factor(df$reason)
#possibly use factor (statt numerisch)
str(df_factorized)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
str(df_factorized_matrix)
#TO DELETE:Cut the categorical values
df_numeric = subset(df_factorized, select = -c(Mjob,Fjob,guardian,reason))
set.seed(99)
train.data <- sample_frac(df_factorized_matrix, 0.7) # select 70% random samples
test.data <- setdiff(df_factorized_matrix,train.data)
#create train and test set with numerical values
train.data_numeric <- sample_frac(df_numeric, 0.7) # select 70% random samples
test.data_numeric <- setdiff(df_numeric,train.data_numeric)
ggplot(aes(x=failures,y=Dalc),data=student_df)+
geom_point()
ggplot(aes(x=Dalc,y=G1, group=Dalc),data=df)+
geom_boxplot()
plot(famrel ~ absences,data=student_df )
res <- cor(student_df)
round(res, 2)
#Correlation Matrix Results: shows strong Correlation between all Grades (cut them or average them)
cormat <- cor(round(df_numeric,2))
corrplot(df_cor, method = "number")
#Try and find other correlations (Reshape Correlation to show highest correlations first)
melted_cormat <- melt(cormat)
head(melted_cormat)
# Get lower triangle of the correlation matrix
get_lower_tri<-function(cormat){
cormat[upper.tri(cormat)] <- NA
return(cormat)
}
# Get upper triangle of the correlation matrix
get_upper_tri <- function(cormat){
cormat[lower.tri(cormat)]<- NA
return(cormat)
}
# Melt the correlation matrix
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Heatmap
ggplot(data = melted_cormat, aes(Var2, Var1, fill = value))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}
# Reorder the correlation matrix
cormat <- reorder_cormat(cormat)
upper_tri <- get_upper_tri(cormat)
# Melt the correlation matrix
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Create a ggheatmap
ggheatmap <- ggplot(melted_cormat, aes(Var2, Var1, fill = value))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",
name="Pearson\nCorrelation") +
theme_minimal()+ # minimal theme
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
# Print the heatmap
print(ggheatmap)
cor_df <- cor(df_factorized_matrix, df_factorized_matrix, method = "pearson")
student_cor_df<- data.frame(cor=cor_df[1:40,41], varn = names(cor_df[1:40,41]))
student_cor_df<- student_cor_df%>%mutate(cor_abs = abs(cor)) %>% arrange(desc(cor_abs))
plot(student_cor_df$cor_abs, type="l")
#Filter out Values with under 15% Correlation
list_var_names <- student_cor_df %>% filter(cor_abs>0.15)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
y <- filter_df %>% select(-Gavg)
pca = prcomp(y, scale. = T, center = T)
plot(pca, type="l")
summary(pca)
pca_df <- data.frame(pca$x)
pca_df <- pca_df %>% select(-PC7,-PC8)
pca_df$Gavg = filter_df$Gavg
pca_model <- lm(data = pca_df, Gavg ~ .)
summary(pca_model)
#Average grades with failures
lm1 <- lm(Gavg ~ failures, data = df_factorized_matrix)
summary(lm1)
#Average grades with failures and higher education (bolean)
lm2 <- lm(Gavg ~ failures+higheryes, data = df_factorized_matrix)
summary(lm2)
#Average grades with failures and higher education and mother education and studytime
lm3 <- lm(Gavg ~ failures+higheryes+Medu+studytime, data = df_factorized_matrix)
summary(lm3)
# "" and father education and school 1 and school 2
lm4 <- lm(Gavg ~ failures+higheryes+Medu+studytime+Fedu+schoolGP+schoolMS, data = df_factorized_matrix)
summary(lm4)
# "" and daily alc. consumption
lm5 <- lm(Gavg ~ failures+higheryes+schoolGP+schoolMS+Medu+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm5)
# all
lm6 <- lm(Gavg ~ .,data = df_factorized_matrix)
summary(lm6)
anova(lm1,lm2, lm3, lm4,lm5, pca_model)
list_var_names <- student_cor_df %>% filter(cor_abs>0.15)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
cor_df <- cor(df_factorized_matrix, df_factorized_matrix, method = "pearson")
student_cor_df<- data.frame(cor=cor_df[1:40,41], varn = names(cor_df[1:40,41]))
student_cor_df<- student_cor_df%>%mutate(cor_abs = abs(cor)) %>% arrange(desc(cor_abs))
plot(student_cor_df$cor_abs, type="l")
y <- filter_df %>% select(-Gavg)
pca = prcomp(y, scale. = T, center = T)
plot(pca, type="l")
summary(pca)
list_var_names <- student_cor_df %>% filter(cor_abs>0.10)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
lm7 <- lm(Gavg ~ paidyes+schoolGP+schoolMS+absences+failures)
summary(lm7)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
str(df_factorized_matrix)
#TO DELETE:Cut the categorical values
df_numeric = subset(df_factorized, select = -c(Mjob,Fjob,guardian,reason))
lm7 <- lm(Gavg ~ paidyes+schoolGP+schoolMS+absences+failures, data = df_factorized_matrix)
summary(lm7)
anova(lm1,lm2, lm3, lm4,lm5, pca_model, lm7)
lm5 <- lm(Gavg ~ failures+higheryes+schoolGP+schoolMS+Medu+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm5)
cor_df <- cor(df_factorized_matrix, df_factorized_matrix, method = "pearson")
student_cor_df<- data.frame(cor=cor_df[1:41,42], varn = names(cor_df[1:41,42]))
student_cor_df<- student_cor_df%>%mutate(cor_abs = abs(cor)) %>% arrange(desc(cor_abs))
plot(student_cor_df$cor_abs, type="l")
#Filter out Values with under 15% Correlation
list_var_names <- student_cor_df %>% filter(cor_abs>0.10)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
cor_df <- cor(df_factorized_matrix, df_factorized_matrix, method = "pearson")
student_cor_df<- data.frame(cor=cor_df[1:41,42], varn = names(cor_df[1:41,42]))
student_cor_df<- student_cor_df%>%mutate(cor_abs = abs(cor)) %>% arrange(desc(cor_abs))
plot(student_cor_df$cor_abs, type="l")
#Filter out Values with under 15% Correlation
list_var_names <- student_cor_df %>% filter(cor_abs>0.15)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
y <- filter_df %>% select(-Gavg)
pca = prcomp(y, scale. = T, center = T)
plot(pca, type="l")
summary(pca)
lm8 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu++classPor+studytime+Fedu+SchoolGP, data = df_factorized_matrix)
summary(lm8)
lm8 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+classPor+studytime+Fedu, data = df_factorized_matrix)
summary(lm8)
anova(lm1,lm2, lm3, lm4,lm5, pca_model, lm7, lm8)
students_mat <- read_csv("student-mat.csv")
students_mat$subject <- "Mat"
students_por<-read_csv("student-por.csv")
students_por$subject <- "Por"
df_raw = rbind(students_por, students_mat)
df<-df_raw %>% distinct(school,sex,age,address,famsize,Pstatus,
Medu,Fedu,Mjob,Fjob,reason,
guardian,traveltime,studytime,failures,
schoolsup, famsup,activities,nursery,higher,internet,
romantic,famrel,freetime,goout,Dalc,Walc,health,absences, .keep_all = TRUE)
View(df)
str(df)
student_df = subset(df, select = -c(G1,G2,G3))
str(student_df)
View(student_df)
df_factorized$subject<-as.numeric(factor(df_factorized$subject))
df_factorized$famsize<-as.numeric(factor(df_factorized$famsize))
df_factorized$Pstatus<-as.numeric(factor(df_factorized$Pstatus))
#Since our GGplot later shows that all Grades have a big correlation with eachtother, we create an avg Grade = Gavg
df$Gavg<-(df$G1+df$G2+df$G3)/3
df_factorized <- student_df
df_factorized <- student_df
df_factorized$subject<-as.numeric(factor(df_factorized$subject))
df_factorized$Pstatus<-as.numeric(factor(df_factorized$Pstatus))
df_factorized$schoolsup<-as.numeric(factor(df_factorized$schoolsup))
df_factorized$famsup<-as.numeric(factor(df_factorized$famsup))
df_factorized$paid<-as.numeric(factor(df_factorized$paid))
df_factorized$nursery<-as.numeric(factor(df_factorized$nursery))
df_factorized$internet<-as.numeric(factor(df_factorized$internet))
df_factorized$romantic<-as.numeric(factor(df_factorized$romantic))
df_factorized$guardian<-as.numeric(factor(df_factorized$guardian))
#Put them in Matrix Model to factorize(or just factorize by hand)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
View(df_numeric)
train.data <- sample_frac(df_factorized_matrix, 0.7) # select 70% random samples
test.data <- setdiff(df_factorized_matrix,train.data)
#-----------------------------------------------------------------------------------------------------------------------------------
#Create Training and Test Set
set.seed(99)
str(df_factorized_matrix)
df_factorized$reason<-as.numeric(factor(df_factorized$reason))
df_factorized$sex<-as.numeric(factor(df_factorized$sex))
df_factorized$Fjob <- as.factor(df$Fjob)
df_factorized$address<-as.numeric(factor(df_factorized$address))
df_factorized$school<-as.numeric(factor(df_factorized$school))
df_factorized$activities<-as.numeric(factor(df_factorized$activities))
#TO DELETE:Cut the categorical values
df_numeric = subset(df_factorized, select = -c(Mjob,Fjob,guardian,reason))
df_factorized$Fjob<-as.numeric(factor(df_factorized$Fjob))
df_factorized$higher<-as.numeric(factor(df_factorized$higher))
df_factorized$famsize<-as.numeric(factor(df_factorized$famsize))
df_factorized$reason <- as.factor(df$reason)
#possibly use factor (statt numerisch)
str(df_factorized)
df_factorized$guardian <- as.factor(df$guardian)
df_factorized$Mjob <- as.factor(df$Mjob)
df_factorized$Mjob<-as.numeric(factor(df_factorized$Mjob))
df_factorized$subject<-as.numeric(factor(df_factorized$subject))
str(df_factorized)
View(df_factorized)
#Put them in Matrix Model to factorize(or just factorize by hand)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
str(df_factorized_matrix)
#TO DELETE:Cut the categorical values
df_numeric = subset(df_factorized, select = -c(Mjob,Fjob,guardian,reason))
View(df_numeric)
str(df_factorized_matrix)
df_factorized$subject<-as.factor(factor(df_factorized$subject))
str(df_factorized)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
str(df_factorized_matrix)
anova(lm1,lm2, lm3, lm4,lm5, pca_model, lm7, lm8)
lm8 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+subjectPor+studytime+Fedu, data = df_factorized_matrix)
summary(lm8)
anova(lm1,lm2, lm3, lm4,lm5, pca_model, lm7, lm8)
#Average grades with failures
lm1 <- lm(Gavg ~ failures, data = df_factorized_matrix)
summary(lm1)
#Average grades with failures and higher education (bolean)
lm2 <- lm(Gavg ~ failures+higheryes, data = df_factorized_matrix)
summary(lm2)
#Average grades with failures and higher education and mother education and studytime
lm3 <- lm(Gavg ~ failures+higheryes+Medu+studytime, data = df_factorized_matrix)
summary(lm3)
# "" and father education and school 1 and school 2
lm4 <- lm(Gavg ~ failures+higheryes+Medu+studytime+Fedu+schoolGP+schoolMS, data = df_factorized_matrix)
summary(lm4)
# "" and daily alc. consumption
lm5 <- lm(Gavg ~ failures+higheryes+schoolGP+schoolMS+Medu+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm5)
lm6 <- lm(Gavg ~ paidyes+schoolGP+schoolMS+absences+failures, data = df_factorized_matrix)
summary(lm6)
lm7 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+subjectPor+studytime+Fedu, data = df_factorized_matrix)
summary(lm7)
# all
lm9 <- lm(Gavg ~ .,data = df_factorized_matrix)
summary(lm9)
#Since our GGplot later shows that all Grades have a big correlation with eachtother, we create an avg Grade = Gavg
df$Gavg<-(df$G1+df$G2+df$G3)/3
student_df = subset(df, select = -c(G1,G2,G3))
str(student_df)
View(student_df)
#TO DO: Manipulate Data so max and min values are set
#Filtering Data to only numeric Data
# dfnum <- Filter(is.numeric, student_df)
# summary(dfnum)
# student_df.pca <- prcomp(dfnum[,c(1:14)],center = TRUE, scale. = TRUE)
# summary(student_df.pca)
# dfnum_cor <- cor(dfnum[1:13], dfnum$G1)
#
# dfnum_withoutgrades <-(dfnum[,c(1:14)])
#factorizing all Data categorical data
df_factorized <- student_df
df_factorized$subject<-as.factor(factor(df_factorized$subject))
df_factorized$famsize<-as.numeric(factor(df_factorized$famsize))
df_factorized$Pstatus<-as.numeric(factor(df_factorized$Pstatus))
df_factorized$address<-as.numeric(factor(df_factorized$address))
df_factorized$sex<-as.numeric(factor(df_factorized$sex))
df_factorized$school<-as.numeric(factor(df_factorized$school))
df_factorized$schoolsup<-as.numeric(factor(df_factorized$schoolsup))
df_factorized$famsup<-as.numeric(factor(df_factorized$famsup))
df_factorized$paid<-as.numeric(factor(df_factorized$paid))
df_factorized$activities<-as.numeric(factor(df_factorized$activities))
df_factorized$nursery<-as.numeric(factor(df_factorized$nursery))
df_factorized$higher<-as.numeric(factor(df_factorized$higher))
df_factorized$internet<-as.numeric(factor(df_factorized$internet))
df_factorized$romantic<-as.numeric(factor(df_factorized$romantic))
df_factorized$guardian<-as.numeric(factor(df_factorized$guardian))
df_factorized$Mjob<-as.numeric(factor(df_factorized$Mjob))
df_factorized$Fjob<-as.numeric(factor(df_factorized$Fjob))
df_factorized$reason<-as.numeric(factor(df_factorized$reason))
#as factor for the categorical Data
df_factorized$Mjob <- as.factor(df$Mjob)
df_factorized$Fjob <- as.factor(df$Fjob)
df_factorized$guardian <- as.factor(df$guardian)
df_factorized$reason <- as.factor(df$reason)
#possibly use factor (statt numerisch)
str(df_factorized)
View(df_factorized)
#Put them in Matrix Model to factorize(or just factorize by hand)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
str(df_factorized_matrix)
#TO DELETE:Cut the categorical values
df_numeric = subset(df_factorized, select = -c(Mjob,Fjob,guardian,reason))
View(df_numeric)
set.seed(99)
train.data <- sample_frac(df_factorized_matrix, 0.7) # select 70% random samples
test.data <- setdiff(df_factorized_matrix,train.data)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
str(df_factorized_matrix)
# all
lm9 <- lm(Gavg ~ .,data = df_factorized_matrix)
summary(lm9)
lm1 <- lm(Gavg ~ failures, data = df_factorized_matrix)
summary(lm1)
#Average grades with failures and higher education (bolean)
lm2 <- lm(Gavg ~ failures+higheryes, data = df_factorized_matrix)
summary(lm2)
#Average grades with failures and higher education and mother education and studytime
lm3 <- lm(Gavg ~ failures+higheryes+Medu+studytime, data = df_factorized_matrix)
summary(lm3)
# "" and father education and school 1 and school 2
lm4 <- lm(Gavg ~ failures+higheryes+Medu+studytime+Fedu+schoolGP+schoolMS, data = df_factorized_matrix)
summary(lm4)
# "" and daily alc. consumption
lm5 <- lm(Gavg ~ failures+higheryes+schoolGP+schoolMS+Medu+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm5)
lm6 <- lm(Gavg ~ paidyes+schoolGP+schoolMS+absences+failures, data = df_factorized_matrix)
summary(lm6)
lm7 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+subjectPor+studytime+Fedu, data = df_factorized_matrix)
summary(lm7)
# all
lm9 <- lm(Gavg ~ .,data = df_factorized_matrix)
summary(lm9)
anova(lm1,lm2, lm3, lm4,lm5, pca_model, lm6, lm7)
lm7 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+subjectPor+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm7)
lm7 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+subjectPor+studytime+Fedu, data = df_factorized_matrix)
summary(lm7)
summary(df_factorized_matrix)
list_var_names <- student_cor_df %>% filter(cor_abs>0.15)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
cor_df <- cor(df_factorized_matrix, df_factorized_matrix, method = "pearson")
student_cor_df<- data.frame(cor=cor_df[1:41,42], varn = names(cor_df[1:41,42]))
student_cor_df<- student_cor_df%>%mutate(cor_abs = abs(cor)) %>% arrange(desc(cor_abs))
plot(student_cor_df$cor_abs, type="l")
list_var_names <- student_cor_df %>% filter(cor_abs>0.15)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
#possibly use factor (statt numerisch)
str(df_factorized)
View(df_factorized)
#Put them in Matrix Model to factorize(or just factorize by hand)
df_factorized_matrix <- data.frame(model.matrix( ~ .- 1, data=student_df))
str(df_factorized_matrix)
#TO DELETE:Cut the categorical values
df_numeric = subset(df_factorized, select = -c(Mjob,Fjob,guardian,reason))
View(df_numeric)
#-----------------------------------------------------------------------------------------------------------------------------------
#Create Training and Test Set
set.seed(99)
train.data <- sample_frac(df_factorized_matrix, 0.7) # select 70% random samples
test.data <- setdiff(df_factorized_matrix,train.data)
#create train and test set with numerical values
train.data_numeric <- sample_frac(df_numeric, 0.7) # select 70% random samples
test.data_numeric <- setdiff(df_numeric,train.data_numeric)
cor_df <- cor(df_factorized_matrix, df_factorized_matrix, method = "pearson")
student_cor_df<- data.frame(cor=cor_df[1:41,42], varn = names(cor_df[1:41,42]))
student_cor_df<- student_cor_df%>%mutate(cor_abs = abs(cor)) %>% arrange(desc(cor_abs))
plot(student_cor_df$cor_abs, type="l")
#Filter out Values with under 15% Correlation
list_var_names <- student_cor_df %>% filter(cor_abs>0.15)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
y <- filter_df %>% select(-Gavg)
pca = prcomp(y, scale. = T, center = T)
plot(pca, type="l")
summary(pca)
#TODO PCA Anpassen mit nur noch 4 Werten
pca_df <- data.frame(pca$x)
pca_df <- pca_df %>% select(-PC7,-PC8)
pca_df$Gavg = filter_df$Gavg
pca_model <- lm(data = pca_df, Gavg ~ .)
summary(pca_model)
list_var_names <- student_cor_df %>% filter(cor_abs>0.15)
filter_df <- data.frame(df_factorized_matrix) %>% select(Gavg,one_of(as.character(list_var_names$varn)))
summary(filter_df)
lm8 <- lm(Gavg ~ failures+higheryes+schoolGP+schoolMS+Medu+subjectPor+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm8)
lm7 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+subjectPor+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm7)
lm8 <- lm(Gavg ~ failures+higheryes+schoolGP+schoolMS+Medu+subjectPor+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm8)
summary(df_factorized_matrix)
lm7 <- lm(Gavg ~ failures+higheryes+schoolGP+Medu+subjectPor+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm7)
lm7 <- lm(Gavg ~ failures+higheryes+schoolGP+subjectMat+Medu+subjectPor+studytime+Fedu+Dalc, data = df_factorized_matrix)
summary(lm7)
str(df_factorized_matrix)
summary(df_factorized_matrix)
anova(lm1,lm2, lm3, lm4,lm5, pca_model, lm6, lm7)
anova(lm1,lm2, lm3, lm4,lm5, lm6, lm7)
ggplot(aes(x=failures,y=Dalc),data=student_df)+
geom_point()
ggplot(aes(x=Dalc,y=G1, group=Dalc),data=df)+
geom_boxplot()
plot(famrel ~ absences,data=student_df )
runApp('shiny_app.R')
install.packages("rocr")
library(DT)
library(shiny)
library(shinythemes)
library(knitr)
library(pander)
library(plotly)
library(plyr)
library(magrittr)
library(readr)
library(rpart)
library(DMwR)
library(dplyr)
library(corrplot)
library(randomForest)
library(ggplot2)
library(reshape2)
install.packages("randomForest")
install.packages("installr"); library(installr) # install+load installr
updateR()
runApp('shiny_app.R')
runApp('shiny_app.R')
runApp('shiny_app.R')
updateR()
runApp('shiny_app.R')
install.packages("DMwR")
runApp('shiny_app.R')
